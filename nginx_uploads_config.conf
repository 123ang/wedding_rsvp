# Nginx Configuration for Uploads Directory
# Add this to your nginx site configuration file
# Usually located at: /etc/nginx/sites-available/your-site-name

# Option 1: Serve uploads directly from nginx (FASTER - Recommended)
# This serves files directly from the filesystem without going through Node.js
location /uploads {
    alias /path/to/your/wedding_rsvp/uploads;
    expires 30d;
    add_header Cache-Control "public, immutable";
    
    # Allow all image and video types
    location ~* \.(jpg|jpeg|png|gif|webp|mp4|mov|avi)$ {
        add_header Access-Control-Allow-Origin *;
    }
}

# Option 2: Proxy uploads to Node.js app (if Option 1 doesn't work)
# Uncomment this if you prefer to serve through Node.js
# location /uploads {
#     proxy_pass http://localhost:3002;
#     proxy_http_version 1.1;
#     proxy_set_header Host $host;
#     proxy_set_header X-Real-IP $remote_addr;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     proxy_set_header X-Forwarded-Proto $scheme;
# }

# Your existing API proxy configuration should look like this:
location /api {
    proxy_pass http://localhost:3002;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# Health check endpoint
location /health {
    proxy_pass http://localhost:3002;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
}

